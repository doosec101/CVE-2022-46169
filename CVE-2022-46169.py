from optparse import OptionParser
from httpx import get
from termcolor import colored

    
def cve_2022_46169():
    parser = OptionParser()
    parser.add_option("-u", "--url", dest="url",help="Url to scan", metavar="URL")
    (options, args) = parser.parse_args()
    url=options.url

    try:
        path= "/cacti/remote_agent.php?action=polldata&poller_id=1&host_id=1&local_data_ids[]=1"
        fullpath=url+path
        response=get(url+path,verify=False,timeout=3)
        if b'FATAL:' in response.content:
            print('[+] '+ fullpath +' >> Might vulnerable check manual\nReferenses:- \nhttps://github.com/0xf4n9x/CVE-2022-46169\nhttps://nvd.nist.gov/vuln/detail/CVE-2022-46169')
        else:
            print(url)
    except Exception:
        print('')
    
cve_2022_46169()
